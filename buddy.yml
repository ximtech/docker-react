- pipeline: "Build and deploy application"
  trigger_mode: "ON_EVERY_PUSH"
  ref_name: "master"
  ref_type: "BRANCH"
  actions:

  - action: "Docker build image"
    type: "DOCKERFILE"
    dockerfile_path: "Dockerfile"
    docker_image_name: "stason/docker-react"
    docker_image_tag: "latest"
    do_not_prune_images: false

  - action: "Run Docker container"
    type: "RUN_DOCKER_CONTAINER"
    docker_image_tag: "latest"
    working_directory: "/app"
    use_image_from_action: true
    mount_filesystem_disable: true
    #inline_commands: "ls"
    inline_commands: "npm run test -- --coverage"
    #mount_filesystem_path: "/buddy/docker-react"
    shell: "SH"

  - action: "Upload files to Elastic Beanstalk"
    type: "ELASTIC_BEANSTALK"
    application_name: "docker-react"
    environment: "e-jmkzhjvspd"
    environment_name: "DockerReact-env"
    region: "us-east-2"
    trigger_condition: "ALWAYS"
    integration_id: 52823
    #deployment_excludes:
    #- "/assets/"
    #- "file.txt"
